# name: test/sql/partitioning/multi_table_partition.test
# description: Test setting the partitioning key of multiple tables in the same transaction
# group: [partitioning]

require ducklake

require parquet

test-env DUCKLAKE_CONNECTION __TEST_DIR__/

test-env DUCKLAKE_CATALOG_DB ducklake_partitioning_multi_table.db

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}${DUCKLAKE_CATALOG_DB}' AS ducklake (DATA_PATH '__TEST_DIR__/ducklake_partitioning_multi_table', METADATA_CATALOG 'ducklake_metadata')

statement ok
USE ducklake

statement ok
CREATE TABLE partitioned_tbl(part_key INTEGER, values VARCHAR);

statement ok
CREATE TABLE partitioned_tbl2(part_key INTEGER, values VARCHAR);

statement ok
BEGIN

statement ok
ALTER TABLE partitioned_tbl SET PARTITIONED BY (part_key);

statement ok
ALTER TABLE partitioned_tbl2 SET PARTITIONED BY (part_key);

statement ok
COMMIT
