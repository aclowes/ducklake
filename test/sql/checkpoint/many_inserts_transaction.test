# name: test/sql/checkpoint/many_inserts_transaction.test
# description: Test checkpoint with many inserts in one transaction
# group: [checkpoint]

require ducklake

require parquet

require icu

statement ok
ATTACH 'ducklake:__TEST_DIR__/many_inserts_transaction.db' AS ducklake (DATA_PATH '__TEST_DIR__/many_inserts_transaction')

statement ok
use ducklake

statement ok
BEGIN;

statement ok
CREATE TABLE integers(i INTEGER);

statement ok
INSERT INTO integers SELECT 1 FROM range(10);

statement ok
INSERT INTO integers SELECT 1;

statement ok
INSERT INTO integers SELECT 2;

statement ok
INSERT INTO integers SELECT 3;

statement ok
COMMIT;

statement ok
CHECKPOINT;

query IIII
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM integers;
----
1	3	13	13