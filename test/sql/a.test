# name: test/sql/a.test
# description: test ducklake extension
# group: [sql]

require ducklake

require parquet

statement ok
ATTACH 'ducklake:/Users/holanda/Desktop/inlining_bug_2/events_ducklake.db' AS ducklake (DATA_PATH '/Users/holanda/Desktop/inlining_bug_2/events_ducklake.db.files/', OVERRIDE_DATA_PATH TRUE)

statement ok
USE ducklake


query IIII
FROM raw_events limit 1
----
2023-01-01 00:00:00	user_1	User One	CLICK

query I
SELECT COUNT(*) FROM user_clicks;
----
0

query I
SELECT COUNT(*) FROM raw_events;
----
821

query III
FROM __ducklake_metadata_ducklake.ducklake_inlined_data_tables
----
1	ducklake_inlined_data_1_1	1
2	ducklake_inlined_data_2_2	2

query IIIIIII
FROM __ducklake_metadata_ducklake.ducklake_inlined_data_2_2
----

query IIIIIII
FROM __ducklake_metadata_ducklake.ducklake_inlined_data_1_1
----

# statement ok
# CALL ducklake_flush_inlined_data('ducklake');
